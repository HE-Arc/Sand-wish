{% extends "sandwish_app/base_generic.html" %}

{% block content %}

    <div class="mt-2">
        <h1>{{ profiles_owner.get_username }}'s profile</h1>
        {% if user.is_authenticated %}
            {% if is_profiles_owner %}
                <button id="show_form_button" onclick="showFormDisplay()" class="btn btn-success" >Create a wishlist</button>
                <div id="wishlist_creation_form" class="row px-3 justify-content-center" style="display: none;">
                    <div class="border rounded p-3 col-12 ">
                        <h3>Create a new wishlist</h3>
                        <form  action="" method="post" >
                            {% csrf_token %}
                            {{ form.as_p }}
                            <button class="btn btn-danger" onclick="hideFormDisplay()">Cancel</button>
                            <input type="submit" class="btn btn-success" value="Create the wishlist" />
                        </form>
                    </div>
                </div>
    </div>
            <h2 class="mt-4">Your wishlists</h2>
            {% else %}
            </div>
                <h2 class="mt-4">User's wishlists</h2>
            {% endif %}
        {% else %}
        </div>
            <h2 class="mt-4">User's wishlists</h2>
        {% endif %}
    <hr>

    <div class="row px-3 mt-3">
        {% for w in wishlists %}
            <div class="col-md-6 p-1">
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title">{{ w.title }}</h3>
                        <p class="card-text">{{ w.description }}</p>
                        <a class="btn btn-primary" href="{% url 'wishlist' username=profiles_owner.username pk=w.id %}">
                            Show the wishlist
                        </a>
                        {% if is_profiles_owner %}
                            <a href="{% url 'wishlist-delete' w.id %}" class="btn btn-danger">x</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <script>
        let showFormDisplay = () => {
            let wishlist_creation_form = document.getElementById("wishlist_creation_form");
            let show_form_button = document.getElementById("show_form_button");

            wishlist_creation_form.style.display = "block";
            show_form_button.style.display = "none";
        };

        let hideFormDisplay = () => {
            let wishlist_creation_form = document.getElementById("wishlist_creation_form");
            let show_form_button = document.getElementById("show_form_button");

            wishlist_creation_form.style.display ="none";
            show_form_button.style.display ="block";
        };
    </script>
{% endblock %}
